³
LC:\Users\patrick.braga\source\repos\Hero\src\Hero.Jobs\Jobs\HeroesSyncJob.cs
	namespace 	
Jobs
 
. 
Jobs 
{ 
public 

class 
HeroesSyncJob 
:  
IJob! %
{ 
public		 
static		 
JobKey		 
JobKey		 #
=		$ %
new		& )
JobKey		* 0
(		0 1
$str		1 C
,		C D
$str		E M
)		M N
;		N O
public

 
static

 

TriggerKey

  

TriggerKey

! +
=

, -
new

. 1

TriggerKey

2 <
(

< =
$str

= S
,

S T
$str

U ]
)

] ^
;

^ _
private 
	IMediator 
mediator "
;" #
public 
HeroesSyncJob 
( 
	IMediator &
mediator' /
)/ 0
{ 	
this 
. 
mediator 
= 
mediator $
;$ %
} 	
public 
async 
Task 
Execute !
(! " 
IJobExecutionContext" 6
context7 >
)> ?
{ 	
Log 
. 
Information 
( 
$str ?
,? @
$strA J
)J K
;K L
} 	
} 
} —
AC:\Users\patrick.braga\source\repos\Hero\src\Hero.Jobs\Program.cs
var 
builder 
= 
WebApplication 
. 
CreateBuilder *
(* +
args+ /
)/ 0
;0 1 
DependencyRegistration

 
.

 
Register

 
(

  
Assembly

  (
.

( ) 
GetExecutingAssembly

) =
(

= >
)

> ?
,

? @
builder

A H
.

H I
Configuration

I V
,

V W
builder

X _
.

_ `
Host

` d
,

d e
builder

f m
.

m n
Services

n v
)

v w
;

w x
builder 
. 
Services 
. 
	Configure 
<  
KestrelServerOptions /
>/ 0
(0 1
o1 2
=>3 5
o6 7
.7 8
AllowSynchronousIO8 J
=K L
trueM Q
)Q R
;R S
builder 
. 
Services 
. 
	AddQuartz 
( 
q 
=> 
q  !
.! "5
)UseMicrosoftDependencyInjectionJobFactory" K
(K L
)L M
)M N
;N O
builder 
. 
Services 
. "
AddQuartzHostedService '
(' (
opt( +
=>, .
opt/ 2
.2 3!
WaitForJobsToComplete3 H
=I J
trueK O
)O P
;P Q
var 
app 
= 	
builder
 
. 
Build 
( 
) 
; 

IScheduler 

	scheduler 
= 
await 
app  
.  !
Services! )
.) *

GetService* 4
<4 5
ISchedulerFactory5 F
>F G
(G H
)H I
.I J
GetSchedulerJ V
(V W
)W X
;X Y
var 
job 
= 	

JobBuilder
 
. 
Create 
< 
HeroesSyncJob )
>) *
(* +
)+ ,
., -
WithIdentity- 9
(9 :
HeroesSyncJob: G
.G H
JobKeyH N
)N O
.O P
BuildP U
(U V
)V W
;W X
var 
trigger 
= 
TriggerBuilder 
. 
Create #
(# $
)$ %
. 
WithIdentity 
( 
HeroesSyncJob 
.  

TriggerKey  *
)* +
. 
WithCronSchedule 
( 
$str )
)) *
. 
Build 

(
 
) 
; 
await 
	scheduler 
. 
ScheduleJob 
( 
job 
,  
trigger! (
)( )
;) *
app 
. 
Map 
( 
string 
. 
Empty 
, 
app 
=> 
{   
app!! 
.!! 
UseCrystalQuartz!! 
(!! 
(!! 
)!! 
=>!! 
	scheduler!! (
)!!( )
;!!) *
}"" 
)"" 
;"" 
app$$ 
.$$ 
Run$$ 
($$ 
)$$ 	
;$$	 
Ô
GC:\Users\patrick.braga\source\repos\Hero\src\Hero.Jobs\SchedulerJobs.cs
	namespace 	
Jobs
 
{ 
public 

class 
SchedulerJobs 
{ 
private 
readonly 

IScheduler #
	scheduler$ -
;- .
public

 
SchedulerJobs

 
(

 

IScheduler

 '
	scheduler

( 1
)

1 2
{ 	
this 
. 
	scheduler 
= 
	scheduler &
;& '
} 	
public 
async 
Task 
< 

IScheduler $
>$ %
CreateScheduler& 5
(5 6
)6 7
{ 	
var 
job 
= 

JobBuilder  
.  !
Create! '
<' (
HeroesSyncJob( 5
>5 6
(6 7
)7 8
.8 9
WithIdentity9 E
(E F
HeroesSyncJobF S
.S T
JobKeyT Z
)Z [
.[ \
Build\ a
(a b
)b c
;c d
var 
trigger 
= 
TriggerBuilder (
.( )
Create) /
(/ 0
)0 1
. 
WithIdentity 
( 
HeroesSyncJob +
.+ ,

TriggerKey, 6
)6 7
. 
WithCronSchedule !
(! "
$str" 5
)5 6
. 
Build 
( 
) 
; 
await 
	scheduler 
. 
ScheduleJob '
(' (
job( +
,+ ,
trigger- 4
)4 5
;5 6
	scheduler 
. 
Start 
( 
) 
; 
return 
	scheduler 
; 
} 	
}   
}!! 